# Production Mosquitto config — password auth, no anonymous access.
#
# Setup:
#   sudo mosquitto_passwd -c /etc/mosquitto/passwd irrigation-hub
#   sudo mosquitto_passwd    /etc/mosquitto/passwd irrigation-node
#   sudo cp mosquitto-production.conf /etc/mosquitto/conf.d/irrigation.conf
#   sudo systemctl restart mosquitto

per_listener_settings true

# Listen on all interfaces so sensor nodes can reach the broker.
# Authentication is required — anonymous connections are rejected.
listener 1883
allow_anonymous false
password_file /etc/mosquitto/passwd

# ACL: restrict which clients can publish to which topics.
# Create /etc/mosquitto/acl with:
#   user irrigation-hub
#   topic readwrite #
#
#   user irrigation-node
#   topic write tele/+/reading
#   topic read valve/+/set
acl_file /etc/mosquitto/acl

# Logging
log_dest syslog
log_type warning
log_type error
log_type notice

# Persistence
persistence true
# persistence_location /var/lib/mosquitto/

# Limits
max_queued_messages 1000
max_inflight_messages 20
